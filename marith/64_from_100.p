load product_code.p
load rt_cor.p

define sffoh(r) -> small_r;
    vars p = 3,i,j;
    [% for j from 2 to 9 do
            for i from 2 to 9 do
                r(p);
                p+1 -> p;
            endfor;
            p+2 -> p;
        endfor; %] -> small_r;
enddefine;


sffoh(miller_rt) -> small_miller_rt;
sffoh(miller_rt_unadj) -> small_miller_rt_unadj;
sffoh(harley_rt) -> small_harley_rt;

pr('2 to 9 from Miller (adjusted):\n');
rt_cor(small_miller_rt);
pr('\n\n2 to 9 from Miller (unadjusted):\n');
rt_cor(small_miller_rt_unadj);
pr('\n\n2 to 9 from Harley:\n');
rt_cor(small_harley_rt);

newgraph();
plot_list(small_miller_rt);
plot_list(small_miller_rt_unadj);
plot_list(small_harley_rt);



vars skew = [17.428 19.837 22.932 21.521 20.115 21.505 22.864 22.021 20.638
     24.237 19.953 29.8851 31.2014 37.2657 37.482 31.3437 34.2969 33.4996
     36.0767 40.3271 23.141 30.5057 26.9112 24.728 35.2474 29.951 31.0643
     32.8324 34.3808 30.0652 21.589 37.8451 24.5486 24.8801 27.7625
     31.2936 29.0938 31.7242 34.1742 26.0823 20.225 41.0533 34.8377
     27.4674 29.136 28.567 31.7093 32.0896 35.0142 32.034 22.338 32.091
     30.455 31.8545 28.4402 25.3345 26.524 32.611 31.7947 27.0113 24.289
     35.1454 31.8752 29.8911 32.2386 26.627 30.5881 27.794 33.4241
     28.269 22.291 35.6828 33.8503 32.1166 32.4417 32.8774 27.7066
     29.7913 33.0004 31.8715 21.087 38.3671 36.7243 35.2234 34.5897
     33.271 33.9849 33.6354 31.6591 27.0547 24.471 42.8076 32.5676
     26.4207 33.7377 27.5298 28.727 32.2868 26.9187 25.7311];


vars equ = [14.524 15.905 18.897 18.301 16.801 17.849 19.23 18.526 17.178
     19.823 15.852 25.2903 28.1763 33.8511 32.8527 29.5591 30.4048
     31.9787 33.4053 34.6407 18.993 28.216 28.3357 24.5735 34.9842
     29.7937 29.2382 32.9839 34.0089 29.4404 18.258 33.9707 24.6586
     25.6414 27.6857 30.4956 28.57 31.2902 32.4441 24.7944 16.909 32.9319
     35.047 27.6664 28.4934 27.8029 30.4737 31.4926 31.5217 31.6605
     18.198 29.4356 29.8087 29.4252 27.8428 25.7013 26.149 31.6235
     30.5574 26.3495 19.532 29.7413 30.0594 28.6529 30.8985 26.1689
     30.1875 26.8731 31.6338 26.9125 18.489 32.1793 33.2689 31.599
     31.3485 31.7471 26.7658 28.9261 31.3332 31.2763 17.294 33.5754
     34.3961 32.5458 32.5314 31.7075 31.9532 31.5299 30.056 25.8071
     19.585 35.0192 30.0199 24.944 31.6926 26.533 26.9154 31.3277 25.8577
     24.9277];


rt_cor(sffoh(skew));
rt_cor(sffoh(equ));

plot_list(sffoh(skew));
rc_print_at(2,34,'2 to 9 for Equalized networks');
